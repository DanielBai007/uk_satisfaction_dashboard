# 学生满意度评价数据分析看板

## 功能概述

这是一个用于分析学生满意度评价数据的可视化看板，支持多维度数据分析和主讲老师维度的专项分析。

## 新增功能：主讲老师分析

### 功能描述
- 支持导入主讲老师信息文件，建立场次ID与主讲老师的映射关系
- 按主讲老师维度统计五星率、一星率及各标签选择率
- 自动计算平均值，便于横向对比

### 数据文件格式

#### 1. 评价数据文件
支持 `.xlsx`, `.xls`, `.csv` 格式，需包含以下字段：
- `evaluation_id`: 评价ID
- `plan_id`: 场次ID（用于与主讲老师信息匹配）
- `stu_id`: 学生ID
- `stu_score`: 评分（1-5分）
- `label`: 标签（多个标签用逗号分隔）
- `stu_content`: 评价内容（JSON格式）
- `app_version_number`: APP版本
- `devices`: 设备信息
- `created_at`: 创建时间

#### 2. 主讲老师信息文件（可选）
支持 `.xlsx`, `.xls`, `.csv` 格式，需包含以下字段：
- `场次ID` 或 `plan_id`: 场次ID
- `主讲老师`: 主讲老师信息，格式为"姓名（工号）"

### 使用方法

1. **上传评价数据**：选择包含学生评价数据的文件
2. **上传主讲老师信息**（可选）：选择包含场次ID和主讲老师映射关系的文件
3. **点击"分析数据"**：系统将自动处理数据并生成分析报告

### 主讲老师分析表格说明

表格包含以下维度：
- **主讲姓名**：从主讲老师信息中提取的姓名
- **五星（满分）率**：
  - 五星率：获得5分评价的比例
  - 讲清楚：选择"讲解很透彻"标签的比例
  - 吸引人：选择"非常幽默"标签的比例
  - 不拖堂：选择"从来不拖堂"标签的比例
- **一星率**：
  - 一星率：获得1分评价的比例
  - 不清楚：选择"讲解混乱"标签的比例
  - 没意思：选择"有点无聊"标签的比例
  - 拖堂：选择"每次都拖堂"标签的比例

### 导出功能

在"主讲老师分析"模块的筛选控件区域，新增了"导出Excel"按钮。

- **功能**：点击该按钮，可以将当前表格中显示的所有主讲老师数据（包括他们的各项指标以及关联的场次数据）导出为 `.xlsx` 格式的Excel文件。
- **筛选与排序**：导出的数据会完全保留您在页面上设置的筛选条件和排序方式，实现"所见即所得"的导出。
- **文件名**：导出的文件会自动以 `主讲老师分析数据_YYYYMMDD_HHMMSS.xlsx` 的格式命名，方便您归档和查找。

### 示例数据

项目中包含示例数据文件：
- `sample_evaluation_data.csv`：示例评价数据
- `sample_teacher_data.csv`：示例主讲老师信息

### 技术特性

- **智能字段识别**：自动识别不同格式的场次ID和主讲老师字段
- **数据验证**：自动验证数据完整性和格式正确性
- **响应式设计**：支持桌面和移动设备访问
- **实时计算**：动态计算各项指标和平均值

## 启动方法

```bash
cd satisfaction_dashboard
python3 -m http.server 8000
```

然后在浏览器中访问 `http://localhost:8000`

## 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+